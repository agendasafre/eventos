import{S as s,s as h}from"./sweetalert2.esm.all-D6Q_Y7Jt.js";const N="/assets/drumroll-BfAPJ4aK.mp3",T="/assets/fanfare-DQO378cn.mp3",y="555255",B=sessionStorage.getItem("internal_key");async function g(){const{value:e}=await s.fire({title:"Acceso restringido",input:"password",inputLabel:"Ingresá la clave de acceso",inputPlaceholder:"••••••",confirmButtonText:"Entrar",background:"#f1faee",color:"#1d3557",allowOutsideClick:!1});return e===y?(sessionStorage.setItem("internal_key",e),!0):(await s.fire({icon:"error",title:"Clave incorrecta",text:"No tenés autorización para acceder.",confirmButtonColor:"#457b9d"}),g())}B!==y&&await g();document.body.classList.add("sorteo");const l=document.getElementById("slotText"),i=document.getElementById("btnStart"),b=document.getElementById("winner"),k=document.getElementById("winnerName"),d=document.getElementById("btnNext"),M=document.getElementById("confetti"),a=new Audio(N),c=new Audio(T);a.volume=.6;c.volume=.8;const L=4500,_=45,w=120;let r=!1;const C=e=>new Promise(n=>setTimeout(n,e)),A=e=>e*(2-e);function K(e){l.textContent=`Nº ${e.numero}`}function q(e){k.textContent=`Nº ${e.numero}`,b.classList.add("show"),D()}function x(){b.classList.remove("show"),E()}function D(){E();const e=["#fff176","#a5d6a7","#81d4fa","#f48fb1","#ffd54f","#b39ddb"],n=400;for(let o=0;o<n;o++){const t=document.createElement("div");t.className="dot",t.style.left=Math.random()*100+"vw",t.style.background=e[Math.floor(Math.random()*e.length)],t.style.animationDuration=3+Math.random()*4+"s",t.style.width=t.style.height=6+Math.random()*6+"px",t.style.opacity=.8+Math.random()*.2,M.appendChild(t)}}function E(){M.innerHTML=""}async function I(){if(r)return;r=!0,i.disabled=!0,x();const{data:e,error:n}=await h.from("entradas").select("numero").eq("entregado",!0).eq("sorteado",!1).order("numero",{ascending:!0});if(n||!e?.length)return r=!1,i.disabled=!1,s.fire("Sin elegibles","No quedan números disponibles.","info");const o=e.sort(()=>Math.random()-.5),t=o[Math.floor(Math.random()*o.length)];a.currentTime=0,a.play();const S=performance.now();let u=0;for(;;){const f=performance.now(),m=Math.min(1,(f-S)/L),v=w-(w-_)*A(m),p=Math.floor(f/v)%10;if(p!==u&&(l.textContent=`Nº ${Math.floor(Math.random()*999)}`,u=p),m>=1)break;await C(16)}a.pause(),a.currentTime=0,K(t),q(t),c.currentTime=0,c.play(),await h.from("entradas").update({sorteado:!0}).eq("numero",t.numero),d.disabled=!1,r=!1}async function O(){d.disabled=!0,x(),l.textContent="Listo para sortear…",await C(500),I()}i.addEventListener("click",I);d.addEventListener("click",O);
