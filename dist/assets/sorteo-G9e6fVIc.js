import{S as r,s as b}from"./sweetalert2.esm.all-BLV7cngM.js";import v from"https://cdn.jsdelivr.net/npm/js-confetti@0.12.0/dist/js-confetti.browser.js";const E="/assets/drumroll-BfAPJ4aK.mp3",T="/assets/fanfare-DQO378cn.mp3",C="4",B=sessionStorage.getItem("internal_key");async function S(){const{value:e}=await r.fire({title:"Acceso restringido",input:"password",inputLabel:"IngresÃ¡ la clave de acceso",inputPlaceholder:"â€¢â€¢â€¢â€¢â€¢â€¢",confirmButtonText:"Entrar",background:"#f1faee",color:"#1d3557",allowOutsideClick:!1});return e===C?(sessionStorage.setItem("internal_key",e),!0):(await r.fire({icon:"error",title:"Clave incorrecta",text:"No tenÃ©s autorizaciÃ³n para acceder.",confirmButtonColor:"#457b9d"}),S())}B!==C&&await S();document.body.classList.add("sorteo");const l=document.getElementById("slotText"),s=document.getElementById("btnStart"),h=document.getElementById("winner"),_=document.getElementById("winnerName"),d=document.getElementById("btnNext"),t=new Audio(E),i=new Audio(T);t.volume=.6;i.volume=.8;const c=new v,k=4500,A=45,g=120;let n=!1;const y=e=>new Promise(o=>setTimeout(o,e)),L=e=>e*(2-e);function K(e){l.textContent=`NÂº ${e.numero}`}function q(e){_.textContent=`NÂº ${e.numero}`,h.classList.add("show")}function x(){h.classList.remove("show"),c.clearCanvas()}async function I(){if(n)return;n=!0,s.disabled=!0,x();const{data:e,error:o}=await b.from("entradas").select("numero").eq("entregado",!0).eq("sorteado",!1).order("numero",{ascending:!0});if(o||!e?.length)return n=!1,s.disabled=!1,r.fire("Sin elegibles","No quedan nÃºmeros disponibles.","info");const u=e.sort(()=>Math.random()-.5),a=u[Math.floor(Math.random()*u.length)];t.currentTime=0,t.play();const N=performance.now();let f=0;for(;;){const m=performance.now(),w=Math.min(1,(m-N)/k),M=g-(g-A)*L(w),p=Math.floor(m/M)%10;if(p!==f&&(l.textContent=`NÂº ${Math.floor(Math.random()*999)}`,f=p),w>=1)break;await y(16)}t.pause(),t.currentTime=0,K(a),q(a),i.currentTime=0,i.play(),c.addConfetti({emojis:["ðŸŽ‰","ðŸ¥³","ðŸŽŠ"],emojiSize:42,confettiNumber:60}),c.addConfetti({confettiColors:["#f1faee","#1d3557","#e63946","#ffb703","#fb8500","#219ebc","#8ecae6","#8338ec","#06d6a0","#ffd166"],confettiRadius:6,confettiNumber:800}),await b.from("entradas").update({sorteado:!0}).eq("numero",a.numero),d.disabled=!1,n=!1}async function O(){d.disabled=!0,x(),l.textContent="Listo para sortearâ€¦",await y(500),I()}s.addEventListener("click",I);d.addEventListener("click",O);
