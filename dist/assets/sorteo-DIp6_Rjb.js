import{s as h,S as N}from"./sweetalert2.esm.all-CxBOCMw6.js";document.body.classList.add("sorteo");const i=document.getElementById("slotText"),r=document.getElementById("btnStart"),w=document.getElementById("winner"),S=document.getElementById("winnerName"),c=document.getElementById("btnNext"),y=document.getElementById("confetti"),a=new Audio("/src/assets/sounds/drumroll.mp3"),d=new Audio("/src/assets/sounds/fanfare.mp3");a.volume=.6;d.volume=.8;const T=4500,C=45,p=120;let s=!1;const M=t=>new Promise(n=>setTimeout(n,t)),v=t=>t*(2-t);function L(t){i.textContent=`Nº ${t.numero}`}function B(t){S.textContent=`Nº ${t.numero}`,w.classList.add("show"),_()}function b(){w.classList.remove("show"),g()}function _(){g();const t=["#fff176","#a5d6a7","#81d4fa","#f48fb1","#ffd54f","#b39ddb"],n=400;for(let o=0;o<n;o++){const e=document.createElement("div");e.className="dot",e.style.left=Math.random()*100+"vw",e.style.background=t[Math.floor(Math.random()*t.length)],e.style.animationDuration=3+Math.random()*4+"s",e.style.width=e.style.height=6+Math.random()*6+"px",e.style.opacity=.8+Math.random()*.2,y.appendChild(e)}}function g(){y.innerHTML=""}async function x(){if(s)return;s=!0,r.disabled=!0,b();const{data:t,error:n}=await h.from("entradas").select("numero").eq("entregado",!0).eq("sorteado",!1).order("numero",{ascending:!0});if(n||!t?.length)return s=!1,r.disabled=!1,N.fire("Sin elegibles","No quedan números disponibles.","info");const o=t.sort(()=>Math.random()-.5),e=o[Math.floor(Math.random()*o.length)];a.currentTime=0,a.play();const E=performance.now();let l=0;for(;;){const m=performance.now(),u=Math.min(1,(m-E)/T),I=p-(p-C)*v(u),f=Math.floor(m/I)%10;if(f!==l&&(i.textContent=`Nº ${Math.floor(Math.random()*999)}`,l=f),u>=1)break;await M(16)}a.pause(),a.currentTime=0,L(e),B(e),d.currentTime=0,d.play(),await h.from("entradas").update({sorteado:!0}).eq("numero",e.numero),c.disabled=!1,s=!1}async function k(){c.disabled=!0,b(),i.textContent="Listo para sortear…",await M(500),x()}r.addEventListener("click",x);c.addEventListener("click",k);
