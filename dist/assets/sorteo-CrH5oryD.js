import{s as h,S as N}from"./sweetalert2.esm.all-C9FIaYH4.js";const S="/assets/drumroll-BfAPJ4aK.mp3",T="/assets/fanfare-DQO378cn.mp3";document.body.classList.add("sorteo");const i=document.getElementById("slotText"),r=document.getElementById("btnStart"),w=document.getElementById("winner"),C=document.getElementById("winnerName"),l=document.getElementById("btnNext"),y=document.getElementById("confetti"),a=new Audio(S),d=new Audio(T);a.volume=.6;d.volume=.8;const v=4500,B=45,p=120;let s=!1;const M=t=>new Promise(n=>setTimeout(n,t)),L=t=>t*(2-t);function A(t){i.textContent=`Nº ${t.numero}`}function _(t){C.textContent=`Nº ${t.numero}`,w.classList.add("show"),k()}function b(){w.classList.remove("show"),g()}function k(){g();const t=["#fff176","#a5d6a7","#81d4fa","#f48fb1","#ffd54f","#b39ddb"],n=400;for(let o=0;o<n;o++){const e=document.createElement("div");e.className="dot",e.style.left=Math.random()*100+"vw",e.style.background=t[Math.floor(Math.random()*t.length)],e.style.animationDuration=3+Math.random()*4+"s",e.style.width=e.style.height=6+Math.random()*6+"px",e.style.opacity=.8+Math.random()*.2,y.appendChild(e)}}function g(){y.innerHTML=""}async function x(){if(s)return;s=!0,r.disabled=!0,b();const{data:t,error:n}=await h.from("entradas").select("numero").eq("entregado",!0).eq("sorteado",!1).order("numero",{ascending:!0});if(n||!t?.length)return s=!1,r.disabled=!1,N.fire("Sin elegibles","No quedan números disponibles.","info");const o=t.sort(()=>Math.random()-.5),e=o[Math.floor(Math.random()*o.length)];a.currentTime=0,a.play();const E=performance.now();let c=0;for(;;){const m=performance.now(),f=Math.min(1,(m-E)/v),I=p-(p-B)*L(f),u=Math.floor(m/I)%10;if(u!==c&&(i.textContent=`Nº ${Math.floor(Math.random()*999)}`,c=u),f>=1)break;await M(16)}a.pause(),a.currentTime=0,A(e),_(e),d.currentTime=0,d.play(),await h.from("entradas").update({sorteado:!0}).eq("numero",e.numero),l.disabled=!1,s=!1}async function q(){l.disabled=!0,b(),i.textContent="Listo para sortear…",await M(500),x()}r.addEventListener("click",x);l.addEventListener("click",q);
